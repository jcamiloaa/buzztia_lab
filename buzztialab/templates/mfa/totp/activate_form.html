{% extends "index-admin.html" %}

{% load allauth i18n %}

{% block title %}
  {% trans "Activate Authenticator App" %} | BuzztiaBal
{% endblock title %}
{% block breadcrumb %}
  <div class="page-header">
    <div class="page-block">
      <div class="row align-items-center">
        <div class="col">
          <div class="page-header-title">
            <h5 class="m-b-10">{% trans "Activate Authenticator App" %}</h5>
          </div>
        </div>
        <div class="col-auto">
          <ul class="breadcrumb">
            <li class="breadcrumb-item">
              <a href="{% url 'home' %}">Home</a>
            </li>
            <li class="breadcrumb-item">
              <a href="{% url 'mfa_index' %}">{% trans "Two-Factor Authentication" %}</a>
            </li>
            <li class="breadcrumb-item" aria-current="page">{% trans "Activate Authenticator App" %}</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
{% endblock breadcrumb %}
{% block content %}
  <div class="row">
    <div class="col-sm-12 col-md-6">
      <div class="card">
        <div class="card-header">
          <h5>{% trans "Activate Authenticator App" %}</h5>
        </div>
        <div class="card-body">
          <div class="alert alert-info">
            <i class="ti ti-info-circle me-2"></i>
            {% blocktranslate %}To protect your account with two-factor authentication, scan the QR code below with your authenticator app. Then, input the verification code generated by the app below.{% endblocktranslate %}
          </div>
          {% url 'mfa_activate_totp' as action_url %}
          <form method="post" action="{{ action_url }}">
            {% csrf_token %}
            <div class="text-center mb-4">
              <img src="{{ totp_svg_data_uri }}"
                   alt="{{ form.secret }}"
                   class="img-fluid" />
            </div>
            <div class="form-group">
              <label class="form-label">{% translate "Authenticator secret" %}</label>
              <input type="text" class="form-control" value="{{ form.secret }}" disabled />
              <small class="text-muted">
                {% translate "You can store this secret and use it to reinstall your authenticator app at a later time." %}
              </small>
            </div>
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">
              <i class="ti ti-check me-1"></i>
              {% trans "Activate" %}
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
{% endblock content %}
